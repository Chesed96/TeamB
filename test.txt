select * from user_tbl
order by 1;

select *
from employees;
--java 에서 조회
--first_name + last_name name 이라는 컬럼으로 만들기 
--Employees테이블 기준 가장 높은 연봉, 내 연봉, 낮은 연봉
--부서코드는 조회하지 않고 부서명을 조회한다.
--매니저 아이디는 조회하지 않고 매니저의 이름을 조회한다.

--사번, 이름, 이메일, 가장 높은 연봉(emp), 사원연봉(emp), 가장 낮은연봉(emp), 부서명, 사원의 매니저 이름

--부서의 가장 높은 연봉, 내 연봉, 낮은 연봉

select e.first_name || ' ' || e.last_name name, e.email, e2.max_sal, e2.min_sal, d.department_name, e1.first_name || ' ' || e1.last_name manager
from   employees e, employees e1,
       (select  max(salary *12) max_sal, min(salary*12) min_sal from employees) e2,
       (select department_id, department_name from   departments) d
where  nvl(e.department_id,0) = nvl(d.department_id,0)
and    nvl(e.manager_id,0) = nvl(e1.employee_id,0);


select e1.first_name || ' ' || e1.last_name manager
from   employees e, employees e1
where    nvl(e.manager_id,0) = nvl(e1.employee_id,0)
and    e.employee_id = 207;

select e.first_name || ' ' || e.last_name name, e.email, e2.max_sal, e2.min_sal, nvl(d.department_name, '없음'), nvl(e1.first_name || ' ' || e1.last_name, '없음') manager
from   employees e, employees e1,
       (select  max(salary *12) max_sal, min(salary*12) min_sal from employees) e2,
       (select department_id, department_name from   departments) d
where  nvl(e.department_id,0) = nvl(d.department_id,0)
and    nvl(e.manager_id,0) = nvl(e1.employee_id,0)
and    e.employee_id = 207;

select e.first_name || ' ' || e.last_name name, e.email, e2.max_sal, e2.min_sal, nvl(d.department_name, '없음'), nvl(e1.first_name || ' ' || e1.last_name, '없음') manager
from   employees e, employees e1,
       (select  max(salary *12) max_sal, min(salary*12) min_sal from employees group by department_id) e2,
       (select department_id, department_name from   departments) d
where  nvl(e.department_id,0) = nvl(d.department_id,0)
and    nvl(e.manager_id,0) = nvl(e1.employee_id,0)
and    e.employee_id = 207;

insert into employees ( employee_id, first_name, last_name, email, salary, hire_date, job_id)
values (207, 'seonguk', 'choi', 'canbin2351@gamil.com', 10000, sysdate, 'AD_PRES');

update employees
set department_id = 90
where employee_id = 207;

update employees
set manager_id = 100
where employee_id = 207;
